window.qc=window.qc||{};
window.ClassManager={id:0|998*Math.random(),instanceId:0|998*Math.random(),compileSuper:function(a,b,c){a=a.toString();var d=a.indexOf("("),e=a.indexOf(")"),d=a.substring(d+1,e),d=d.trim(),e=a.indexOf("{"),f=a.lastIndexOf("}");for(a=a.substring(e+1,f);-1!=a.indexOf("this._super");){var e=a.indexOf("this._super"),f=a.indexOf("(",e),g=a.indexOf(")",f),g=a.substring(f+1,g),g=(g=g.trim())?",":"";a=a.substring(0,e)+"ClassManager["+c+"]."+b+".call(this"+g+a.substring(f+1)}return Function(d,a)},getNewID:function(){return this.id++},
getNewInstanceId:function(){return this.instanceId++}};ClassManager.compileSuper.ClassManager=ClassManager;
(function(){var a=/\b_super\b/;qc.Class=function(){};qc.Class.extend=function(b){function c(){this.__instanceId=ClassManager.getNewInstanceId();this.ctor&&this.ctor.apply(this,arguments)}var d=this.prototype,e=Object.create(d),f=ClassManager.getNewID();ClassManager[f]=d;var g={writable:!0,enumerable:!1,configurable:!0};e.__instanceId=null;c.id=f;g.value=f;Object.defineProperty(e,"__pid",g);c.prototype=e;g.value=c;Object.defineProperty(c.prototype,"constructor",g);this.__getters__&&(c.__getters__=
qc.clone(this.__getters__));this.__setters__&&(c.__setters__=qc.clone(this.__setters__));for(var h=0,l=arguments.length;h<l;++h){var k=arguments[h],m;for(m in k){var n="function"===typeof k[m],r="function"===typeof d[m],p=a.test(k[m]);n&&r&&p?(g.value=ClassManager.compileSuper(k[m],m,f),Object.defineProperty(e,m,g)):n&&r&&p?(g.value=function(a,b){return function(){var c=this._super;this._super=d[a];var e=b.apply(this,arguments);this._super=c;return e}}(m,k[m]),Object.defineProperty(e,m,g)):n?(g.value=
k[m],Object.defineProperty(e,m,g)):e[m]=k[m];if(n){var q,t;if(this.__getters__&&this.__getters__[m]){var n=this.__getters__[m],s;for(s in this.__setters__)if(this.__setters__[s]==n){t=s;break}qc.defineGetterSetter(e,n,k[m],k[t]?k[t]:e[t],m,t)}if(this.__setters__&&this.__setters__[m]){n=this.__setters__[m];for(s in this.__getters__)if(this.__getters__[s]==n){q=s;break}qc.defineGetterSetter(e,n,k[q]?k[q]:e[q],k[m],q,m)}}}}c.extend=qc.Class.extend;c.implement=function(a){for(var b in a)e[b]=a[b]};return c};
Function.prototype.bind=Function.prototype.bind||function(a){var c=this;return function(){var d=Array.prototype.slice.call(arguments);return c.apply(a||null,d)}}})();
qc.defineGetterSetter=function(a,b,c,d,e,f){if(a.__defineGetter__)c&&a.__defineGetter__(b,c),d&&a.__defineSetter__(b,d);else if(Object.defineProperty){var g={enumerable:!1,configurable:!0};c&&(g.get=c);d&&(g.set=d);Object.defineProperty(a,b,g)}else throw Error("browser does not support getters");if(!e&&!f)for(var g=null!=c,h=void 0!=d,l=Object.getOwnPropertyNames(a),k=0;k<l.length;k++){var m=l[k];if((a.__lookupGetter__?!a.__lookupGetter__(m):!Object.getOwnPropertyDescriptor(a,m))&&"function"===typeof a[m]){var n=
a[m];if(g&&n===c&&(e=m,!h||f))break;if(h&&n===d&&(f=m,!g||e))break}}a=a.constructor;e&&(a.__getters__||(a.__getters__={}),a.__getters__[e]=b);f&&(a.__setters__||(a.__setters__={}),a.__setters__[f]=b)};qc.clone=function(a){var b=a.constructor?new a.constructor:{},c;for(c in a){var d=a[c];b[c]="object"!=typeof d||!d||d instanceof qc.Node||d instanceof HTMLElement?d:qc.clone(d)}return b};qc.g_NumberOfDraws=0;qc.defaultFPS=60;
qc.Director=qc.Class.extend({_animationInterval:null,_scenesStack:null,_lastUpdate:null,_frameRate:0,_purgeDirectorInNextLoop:!1,invalid:!1,_deltaTime:0,_nextScene:null,_runningScene:null,_sendCleanupToScene:!1,_actionManager:null,ctor:function(){this._lastUpdate=Date.now()},init:function(){this._animationInterval=1/qc.defaultFPS;this._scenesStack=[];this._lastUpdate=Date.now();this._actionManager=qc.ActionManager._getInstance();qc.log(this._actionManager);this._paused=!1;return!0},getWinSize:function(){return qc.size(qc._canvas.width,
qc._canvas.height)},mainLoop:function(){this._purgeDirectorInNextLoop?(this._purgeDirectorInNextLoop=!1,this.purgeDirector()):this.invalid||this.drawScene()},calculateDeltaTime:function(){var a=Date.now();this._deltaTime=(a-this._lastUpdate)/1E3;this._lastUpdate=a},_clear:function(){var a=qc.rect(0,0,qc._canvas.width,qc._canvas.height);qc._renderContext.clearRect(-a.x,a.y,a.width,-a.height)},setNextScene:function(){var a=this._runningScene;a&&(a.onExit(),a.cleanup());this._runningScene=this._nextScene;
this._nextScene=null;this._runningScene.onEnter()},getActionManager:function(){return this._actionManager},drawScene:function(){this.calculateDeltaTime();this._paused||this._actionManager.update(this._deltaTime);this._clear();this._nextScene&&this.setNextScene();this._beforeVisitScene&&this._beforeVisitScene();this._runningScene&&this._runningScene.visit();this._afterVisitScene&&this._afterVisitScene()},_beforeVisitScene:null,_afterVisitScene:null,purgeDirector:function(){},pushScene:function(a){this._sendCleanupToScene=
!1;this._scenesStack.push(a);this._nextScene=a},runScene:function(a){if(this._runningScene){var b=this._scenesStack.length;0===b?(this._sendCleanupToScene=!0,this._scenesStack[b]=a):(this._sendCleanupToScene=!0,this._scenesStack[b-1]=a);this._nextScene=a}else this.pushScene(a)}});qc.Director.sharedDirector=null;qc.Director.firstUseDirector=!0;
qc.Director._getInstance=function(){qc.Director.firstUseDirector&&(qc.Director.firstUseDirector=!1,qc.Director.sharedDirector=new qc.Director,qc.Director.sharedDirector.init());return qc.Director.sharedDirector};qc._loadingImage="";qc.newElement=function(a){return document.createElement(a)};qc._addEventListener=function(a,b,c,d){a.addEventListener(b,c,d)};qc.each=function(a,b,c){if(a)if(a instanceof Array)for(var d=0,e=a.length;d<e&&!1!==b.call(c,a[d],d);d++);else for(d in a)if(!1===b.call(c,a[d],d))break};qc.isCrossOrigin=function(a){if(!a)return qc.log("invalid URL"),!1;var b=a.indexOf("://");if(-1==b)return!1;b=a.indexOf("/",b+3);return(-1==b?a:a.substring(0,b))!=location.origin};
qc.path={join:function(){for(var a=arguments.length,b="",c=0;c<a;c++)b=(b+(""==b?"":"/")+arguments[c]).replace(/(\/|\\\\)$/,"");return b},extname:function(a){return(a=/(\.[^\.\/\?\\]*)(\?.*)?$/.exec(a))?a[1]:null},mainFileName:function(a){if(a){var b=a.lastIndexOf(".");if(-1!==b)return a.substring(0,b)}return a},basename:function(a,b){var c=a.indexOf("?");0<c&&(a=a.substring(0,c));c=/(\/|\\\\)([^(\/|\\\\)]+)$/g.exec(a.replace(/(\/|\\\\)$/,""));if(!c)return null;c=c[2];return b&&a.substring(a.length-
b.length).toLowerCase()==b.toLowerCase()?c.substring(0,c.length-b.length):c},dirname:function(a){return a.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(a,b){b=b||"";var c=a.indexOf("?"),d="";0<c&&(d=a.substring(c),a=a.substring(0,c));c=a.lastIndexOf(".");return 0>c?a+b+d:a.substring(0,c)+b+d},changeBasename:function(a,b,c){if(0==b.indexOf("."))return this.changeExtname(a,b);var d=a.indexOf("?"),e="";c=c?this.extname(a):"";0<d&&(e=a.substring(d),a=a.substring(0,d));d=a.lastIndexOf("/");
return a.substring(0,0>=d?0:d+1)+b+c+e}};
qc.async={_counterFunc:function(a){var b=this.counter;if(!b.err){var c=b.length,d=b.results,e=b.option,f=e.cb,g=e.cbTarget,h=e.trigger,e=e.triggerTarget;if(a){if(b.err=a,f)return f.call(g,a)}else{var l=Array.apply(null,arguments).slice(1),k=l.length;0==k?l=null:1==k&&(l=l[0]);d[this.index]=l;b.count--;h&&h.call(e,l,c-b.count,c);0==b.count&&f&&f.apply(g,[null,d])}}},_emptyFunc:function(){},parallel:function(a,b,c){var d=qc.async;if(void 0!==c)"function"==typeof b&&(b={trigger:b}),b.cb=c||b.cb;else if(void 0!==
b)"function"==typeof b&&(b={cb:b});else if(void 0!==a)b={};else throw"arguments error!";var e=(c=a instanceof Array)?a.length:Object.keys(a).length;if(0==e)b.cb&&b.cb.call(b.cbTarget,null);else{var f={length:e,count:e,option:b,results:c?[]:{}};qc.each(a,function(a,c){if(f.err)return!1;var e=b.cb||b.trigger?d._counterFunc.bind({counter:f,index:c}):d._emptyFunc;a(e,c)})}},map:function(a,b,c){var d=this,e=arguments.length;"function"==typeof b&&(b={iterator:b});if(3===e)b.cb=c||b.cb;else if(2>e)throw"arguments error!";
"function"==typeof b&&(b={iterator:b});if(void 0!==c)b.cb=c||b.cb;else if(void 0===a)throw"arguments error!";var f=(e=a instanceof Array)?a.length:Object.keys(a).length;if(0===f)b.cb&&b.cb.call(b.cbTarget,null);else{var g={length:f,count:f,option:b,results:e?[]:{}};qc.each(a,function(a,c){if(g.err)return!1;var e=b.cb?d._counterFunc.bind({counter:g,index:c}):d._emptyFunc;b.iterator.call(b.iteratorTarget,a,c,e)})}}};
qc.loader={_jsCache:{},_register:{},_langPathCache:{},_aliases:{},resPath:"",audioPath:"",cache:{},getXMLHttpRequest:function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},_getArgs4Js:function(a){var b=a[0],c=a[1],d=a[2],e=["",null,null];if(1===a.length)e[1]=b instanceof Array?b:[b];else if(2===a.length)"function"==typeof c?(e[1]=b instanceof Array?b:[b],e[2]=c):(e[0]=b||"",e[1]=c instanceof Array?c:[c]);else if(3===a.length)e[0]=b||"",e[1]=c instanceof
Array?c:[c],e[2]=d;else throw"arguments error to load js!";return e},loadJs:function(a,b,c){var d=this,e=d._jsCache,f=d._getArgs4Js(arguments);qc.async.map(f[1],function(a,b,c){a=qc.path.join(f[0],a);if(e[a])return c(null);d._createScript(a,!1,c)},f[2])},loadJsWithImg:function(a,b,c){var d=this._loadJsImg(),e=this._getArgs4Js(arguments);this.loadJs(e[0],e[1],function(a){if(a)throw a;d.parentNode.removeChild(d);if(e[2])e[2]()})},_createScript:function(a,b,c){var d=document,e=qc.newElement("script");
e.async=b;e.src=a;this._jsCache[a]=!0;qc._addEventListener(e,"load",function(){this.removeEventListener("load",arguments.callee,!1);c()},!1);qc._addEventListener(e,"error",function(){c("Load "+a+" failed!")},!1);d.body.appendChild(e)},_loadJsImg:function(){var a=document,b=a.getElementById("loadJsImg");if(!b){b=qc.newElement("img");qc._loadingImage&&(b.src=qc._loadingImage);a=a.getElementById(qc.game.config.id);a.style.backgroundColor="black";a.parentNode.appendChild(b);var c=getComputedStyle?getComputedStyle(a):
a.currentStyle;c||(c={width:a.width,height:a.height});b.style.left=a.offsetLeft+(parseFloat(c.width)-b.width)/2+"px";b.style.top=a.offsetTop+(parseFloat(c.height)-b.height)/2+"px";b.style.position="absolute"}return b},loadTxt:function(a,b){var c=this.getXMLHttpRequest(),d="load "+a+" failed!";c.open("GET",a,!0);/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(c.setRequestHeader("Aqcept-Charset","utf-8"),c.onreadystatechange=function(){4==c.readyState&&200==c.status?b(null,c.responseText):
b(d)}):(c.overrideMimeType&&c.overrideMimeType("text/plain; charset\x3dutf-8"),c.onload=function(){4==c.readyState&&200==c.status?b(null,c.responseText):b(d)});c.send(null)},_loadTxtSync:function(a){var b=this.getXMLHttpRequest();b.open("GET",a,!1);/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?b.setRequestHeader("Aqcept-Charset","utf-8"):b.overrideMimeType&&b.overrideMimeType("text/plain; charset\x3dutf-8");b.send(null);return 4==!b.readyState||200!=b.status?null:b.responseText},
loadJson:function(a,b){this.loadTxt(a,function(c,d){try{c?b(c):b(null,JSON.parse(d))}catch(e){throw"load json ["+a+"] failed : "+e;}})},_checkIsImageURL:function(a){return null!=/(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(a)},loadImg:function(a,b,c){void 0===c&&void 0!==b&&(c=b);var d=new Image;qc._addEventListener(d,"load",function(){this.removeEventListener("load",arguments.callee,!1);this.removeEventListener("error",arguments.callee,!1);c&&c(null,d)});qc._addEventListener(d,"error",function(){this.removeEventListener("error",
arguments.callee,!1);c&&c("load image failed")});d.src=a;return d},_loadResIterator:function(a,b,c){var d=this,e=null,f=a.type;f?(f="."+f.toLowerCase(),e=a.src?a.src:a.name+f):(e=a,f=qc.path.extname(e));if(b=d.cache[e])return c(null,b);b=d._register[f.toLowerCase()];if(!b)return qc.error("loader for ["+f+"] not exists!"),c();f=b.getBasePath?b.getBasePath():d.resPath;f=d.getUrl(f,e);b.load(f,e,a,function(a,b){a?(qc.log(a),d.cache[e]=null,delete d.cache[e],c()):(d.cache[e]=b,c(null,b))})},getUrl:function(a,
b){var c=this._langPathCache,d=qc.path;if(void 0!==a&&void 0===b){b=a;var e=d.extname(b),e=e?e.toLowerCase():"";a=(e=this._register[e])?e.getBasePath?e.getBasePath():this.resPath:this.resPath}b=qc.path.join(a||"",b);if(b.match(/[\/(\\\\)]lang[\/(\\\\)]/i)){if(c[b])return c[b];d=d.extname(b)||"";b=c[b]=b.substring(0,b.length-d.length)+"_"+qc.sys.language+d}return b},load:function(a,b,c){if(void 0!==c)"function"==typeof b&&(b={trigger:b});else if(void 0!==b)"function"==typeof b&&(c=b,b={});else if(void 0!==
a)b={};else throw"arguments error!";b.cb=function(a,b){a&&qc.log(a);c&&c(b)};a instanceof Array||(a=[a]);b.iterator=this._loadResIterator;b.iteratorTarget=this;qc.async.map(a,b)},_handleAliases:function(a,b){var c=this._aliases,d=[],e;for(e in a){var f=a[e];c[e]=f;d.push(f)}this.load(d,b)},loadAliases:function(a,b){var c=this,d=c.getRes(a);d?c._handleAliases(d.filenames,b):c.load(a,function(a){c._handleAliases(a[0].filenames,b)})},register:function(a,b){if(a&&b){if("string"==typeof a)return this._register[a.trim().toLowerCase()]=
b;for(var c=0,d=a.length;c<d;c++)this._register["."+a[c].trim().toLowerCase()]=b}},getRes:function(a){return this.cache[a]||this.cache[this._aliases[a]]},release:function(a){var b=this.cache,c=this._aliases;delete b[a];delete b[c[a]];delete c[a]},releaseAll:function(){var a=this.cache,b=this._aliases,c;for(c in a)delete a[c];for(c in b)delete b[c]}};qc.p=function(a,b){return void 0==a?{x:0,y:0}:void 0==b?{x:a.x,y:a.y}:{x:a,y:b}};
qc.size=function(a,b){return void 0===a?{width:0,height:0}:void 0===b?{width:a.width,height:a.height}:{width:a,height:b}};qc.rect=function(a,b,c,d){return void 0===a?{x:0,y:0,width:0,height:0}:void 0===b?{x:a.x,y:a.y,width:a.width,height:a.height}:{x:a,y:b,width:c,height:d}};qc.color=function(a,b,c){return{r:a,g:b,b:c}};qc._formatString=function(a){if("object"===typeof a)try{return JSON.stringify(a)}catch(b){return""}else return a};qc.assert=function(a,b){if(!a&&b)throw b;};
qc.log=function(a){for(var b=1;b<arguments.length;b++)a=a.replace(/(%s)|(%d)/,qc._formatString(arguments[b]));console.log(a)};qc.warn=console.warn?function(a){for(var b=1;b<arguments.length;b++)a=a.replace(/(%s)|(%d)/,qc._formatString(arguments[b]));console.warn(a)}:qc.log;qc.error=console.error?function(a){for(var b=1;b<arguments.length;b++)a=a.replace(/(%s)|(%d)/,qc._formatString(arguments[b]));console.error(a)}:qc.log;
qc.arrayRemoveObject=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]==b){a.splice(c,1);break}};qc._rectEqualToZero=function(a){return a&&0===a.x&&0===a.y&&0===a.width&&0===a.height};
qc._initSys=function(a,b){qc._RENDER_TYPE_CANVAS=0;var c=qc.sys={};c.LANGUAGE_ENGLISH="en";c.LANGUAGE_CHINESE="zh";c.LANGUAGE_FRENCH="fr";c.LANGUAGE_ITALIAN="it";c.LANGUAGE_GERMAN="de";c.LANGUAGE_SPANISH="es";c.LANGUAGE_RUSSIAN="ru";c.LANGUAGE_KOREAN="ko";c.LANGUAGE_JAPANESE="ja";c.LANGUAGE_HUNGARIAN="hu";c.LANGUAGE_PORTUGUESE="pt";c.LANGUAGE_ARABIC="ar";c.LANGUAGE_NORWEGIAN="no";c.LANGUAGE_POLISH="pl";c.OS_WINDOWS="Windows";c.OS_IOS="iOS";c.OS_OSX="OS X";c.OS_UNIX="UNIX";c.OS_LINUX="Linux";c.OS_ANDROID=
"Android";c.OS_UNKNOWN="Unknown";c.BROWSER_TYPE_WECHAT="wechat";c.BROWSER_TYPE_ANDROID="androidbrowser";c.BROWSER_TYPE_IE="ie";c.BROWSER_TYPE_QQ="qqbrowser";c.BROWSER_TYPE_MOBILE_QQ="mqqbrowser";c.BROWSER_TYPE_UC="ucbrowser";c.BROWSER_TYPE_360="360browser";c.BROWSER_TYPE_BAIDU_APP="baiduboxapp";c.BROWSER_TYPE_BAIDU="baidubrowser";c.BROWSER_TYPE_MAXTHON="maxthon";c.BROWSER_TYPE_OPERA="opera";c.BROWSER_TYPE_MIUI="miuibrowser";c.BROWSER_TYPE_FIREFOX="firefox";c.BROWSER_TYPE_SAFARI="safari";c.BROWSER_TYPE_CHROME=
"chrome";c.BROWSER_TYPE_UNKNOWN="unknown";c.isNative=!1;var d=[c.BROWSER_TYPE_BAIDU,c.BROWSER_TYPE_OPERA,c.BROWSER_TYPE_FIREFOX,c.BROWSER_TYPE_CHROME,c.BROWSER_TYPE_SAFARI],e=[c.BROWSER_TYPE_BAIDU,c.BROWSER_TYPE_OPERA,c.BROWSER_TYPE_FIREFOX,c.BROWSER_TYPE_CHROME,c.BROWSER_TYPE_SAFARI,c.BROWSER_TYPE_UC,c.BROWSER_TYPE_QQ,c.BROWSER_TYPE_MOBILE_QQ,c.BROWSER_TYPE_IE],f=window,g=f.navigator,h=document.documentElement,l=g.userAgent.toLowerCase();c.isMobile=-1!=l.indexOf("mobile")||-1!=l.indexOf("android");
var k=g.language,k=(k=k?k:g.browserLanguage)?k.split("-")[0]:c.LANGUAGE_ENGLISH;c.language=k;var k=c.BROWSER_TYPE_UNKNOWN,m=l.match(/micromessenger|qqbrowser|mqqbrowser|ucbrowser|360browser|baiduboxapp|baidubrowser|maxthon|trident|opera|miuibrowser|firefox/i)||l.match(/chrome|safari/i);m&&0<m.length&&(k=m[0].toLowerCase(),"micromessenger"==k?k=c.BROWSER_TYPE_WECHAT:"safari"===k&&l.match(/android.*applewebkit/)?k=c.BROWSER_TYPE_ANDROID:"trident"==k&&(k=c.BROWSER_TYPE_IE));c.browserType=k;c._supportMultipleAudio=
-1<e.indexOf(c.browserType);e=parseInt(a[b.renderMode]);k=qc._RENDER_TYPE_CANVAS;m=qc.newElement("Canvas");qc._supportRender=!0;d=-1==d.indexOf(c.browserType);if(1===e||0===e&&(c.isMobile||d))k=qc._RENDER_TYPE_CANVAS;if(k==qc._RENDER_TYPE_CANVAS)try{m.getContext("2d")}catch(n){qc._supportRender=!1}qc._renderType=k;try{c._supportWebAudio=!!new (f.AudioContext||f.webkitAudioContext||f.mozAudioContext)}catch(r){c._supportWebAudio=!1}try{var p=c.localStorage=f.localStorage;p.setItem("storage","");p.removeItem("storage");
p=null}catch(q){"SECURITY_ERR"!==q.name&&"QuotaExceededError"!==q.name||qc.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option"),c.localStorage=function(){}}p=c.capabilities={canvas:!0};void 0!==h.ontouchstart||g.msPointerEnabled?p.touches=!0:void 0!==h.onmouseup&&(p.mouse=!0);void 0!==h.onkeyup&&(p.keyboard=!0);if(f.DeviceMotionEvent||f.DeviceOrientationEvent)p.aqcelerometer=!0;f=l.match(/(iPad|iPhone|iPod)/i)?!0:!1;l=l.match(/android/i)||g.platform.match(/android/i)?
!0:!1;h=c.OS_UNKNOWN;-1!=g.appVersion.indexOf("Win")?h=c.OS_WINDOWS:f?h=c.OS_IOS:-1!=g.appVersion.indexOf("Mac")?h=c.OS_OSX:-1!=g.appVersion.indexOf("X11")?h=c.OS_UNIX:-1!=g.appVersion.indexOf("Linux")?h=c.OS_LINUX:l&&(h=c.OS_ANDROID);c.os=h;c.garbageCollect=function(){};c.dumpRoot=function(){};c.restartVM=function(){};c.dump=function(){var a;a=""+("isMobile : "+this.isMobile+"\r\n");a+="language : "+this.language+"\r\n";a+="browserType : "+this.browserType+"\r\n";a+="capabilities : "+JSON.stringify(this.capabilities)+
"\r\n";a+="os : "+this.os+"\r\n";qc.log(a)}};qc.ORIENTATION_PORTRAIT=0;qc.ORIENTATION_PORTRAIT_UPSIDE_DOWN=1;qc.ORIENTATION_LANDSCAPE_LEFT=2;qc.ORIENTATION_LANDSCAPE_RIGHT=3;qc._drawingUtil=null;qc._renderContext=null;qc._canvas=null;qc._gameDiv=null;qc._rendererInitialized=!1;qc._setupCalled=!1;
qc._setup=function(a,b,c){if(!qc._setupCalled){qc._setupCalled=!0;var d=window;d.requestAnimFrame=d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame||d.oRequestAnimationFrame||d.msRequestAnimationFrame;var e=qc.$(a)||qc.$("#"+a),f,g;"CANVAS"==e.tagName?(b=b||e.width,c=c||e.height,g=qc.newElement("DIV"),g.setAttribute("class","horizontal_center"),d=qc.container=qc.newElement("DIV"),a=qc._canvas=e,a.parentNode.insertBefore(g,a),a.parentNode.insertBefore(d,a),qc.$(d).appendTo(g),
a.appendTo(d),d.setAttribute("id","QCGameContainer")):("DIV"!=e.tagName&&qc.log("Warning: target element is not a DIV or CANVAS"),b=b||e.clientWidth,c=c||e.clientHeight,d=qc.container=e,a=qc._canvas=qc.$(qc.newElement("CANVAS")),e.appendChild(a));a.addClass("gameCanvas");a.setAttribute("width",b||480);a.setAttribute("height",c||320);a.setAttribute("tabindex",99);a.style.outline="none";e=a.style;e.width="100%";e.height="100%";f=d.style;f.width=(b||480)+"px";f.height=(c||320)+"px";f.margin="0 auto";
f.position="relative";f.overflow="hidden";d.top="100%";qc._renderContext=a.getContext("2d");qc._mainRenderContextBackup=qc._renderContext;qc._renderContext.translate(0,a.height);qc._gameDiv=d;qc.sys.isMobile&&(a=qc.newElement("style"),a.type="text/css",document.body.appendChild(a),a.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}");a=qc.resizeCall=function(){var a=window.innerWidth,
d=window.innerHeight,e;b/c>a/d?(e=a,a=a/b*c):(a=d,e=d/c*b);f.width=(e||480)+"px";f.height=(a||320)+"px";g.style.width="100%";g.style.height=d+"px"};a();window.addEventListener("resize",a,!1);qc.EventManager.registerSystemEvent(qc._canvas);qc.director=qc.Director._getInstance();qc.winSize=qc.director.getWinSize();qc.log(qc.winSize)}};
qc.game={DEBUG_MODE_NONE:0,DEBUG_MODE_INFO:1,DEBUG_MODE_WARN:2,DEBUG_MODE_ERROR:3,DEBUG_MODE_INFO_FOR_WEB_PAGE:4,DEBUG_MODE_WARN_FOR_WEB_PAGE:5,DEBUG_MODE_ERROR_FOR_WEB_PAGE:6,EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",_eventHide:null,_eventShow:null,_onBeforeStartArr:[],CONFIG_KEY:{engineDir:"engineDir",dependencies:"dependencies",debugMode:"debugMode",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",jsList:"jsList",classReleaseMode:"classReleaseMode"},_prepareCalled:!1,
_prepared:!1,_paused:!0,_intervalId:null,config:null,onStart:null,onStop:null,setFrameRate:function(a){this.config[this.CONFIG_KEY.frameRate]=a;this._intervalId&&clearInterval(this._intervalId);this._paused=!0;this._runMainLoop()},_runMainLoop:function(){var a=qc.director;this._intervalId=setInterval(function(){a.mainLoop()},1E3/this.config[this.CONFIG_KEY.frameRate]);this._paused=!1},stop:function(){this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null)},run:function(a){var b=
this,c=function(){a&&(b.config[b.CONFIG_KEY.id]=a);qc._supportRender&&(qc._setup(b.config[b.CONFIG_KEY.id]),b._runMainLoop(),b.onStart(),b._checkPrepare=setInterval(function(){clearInterval(b._checkPrepare)},10))};document.body?c():qc._addEventListener(window,"load",function(){this.removeEventListener("load",arguments.callee,!1);c()},!1)},_initConfig:function(){var a=this.CONFIG_KEY,b=function(b){b[a.engineDir]=b[a.engineDir]||"frameworks/qunar-c";b[a.frameRate]=b[a.frameRate]||60;return b};if(document.qcConfig)this.config=
b(document.qcConfig);else try{this.config=b({project_type:"javascript",frameRate:60,id:"gameCanvas",engineDir:"",jsList:[]})}catch(c){qc.log("Failed to read or parse project.json"),this.config=b({})}qc._initSys(this.config,a)},_jsAddedCache:{},_getJsListOfModule:function(a,b,c){var d=this._jsAddedCache;if(d[b])return null;c=c||"";var e=[],f=a[b];if(!f)throw"can not find module ["+b+"]";b=qc.path;for(var g=0,h=f.length;g<h;g++){var l=f[g];if(!d[l]){var k=b.extname(l);k?".js"==k.toLowerCase()&&e.push(b.join(c,
l)):(k=this._getJsListOfModule(a,l,c))&&(e=e.concat(k));d[l]=1}}return e}};qc.game._initConfig();qc.$=function(a){var b=this==qc?document:this;if(a=a instanceof HTMLElement?a:b.querySelector(a))a.find=a.find||qc.$,a.hasClass=a.hasClass||function(a){return this.className.match(RegExp("(\\s|^)"+a+"(\\s|$)"))},a.addClass=a.addClass||function(a){this.hasClass(a)||(this.className&&(this.className+=" "),this.className+=a);return this},a.removeClass=a.removeClass||function(a){this.hasClass(a)&&(this.className=this.className.replace(a,""));return this},a.remove=a.remove||function(){this.parentNode&&
this.parentNode.removeChild(this);return this},a.appendTo=a.appendTo||function(a){a.appendChild(this);return this},a.prependTo=a.prependTo||function(a){a.childNodes[0]?a.insertBefore(this,a.childNodes[0]):a.appendChild(this);return this},a.transforms=a.transforms||function(){this.style[qc.$.trans]=qc.$.translate(this.position)+qc.$.rotate(this.rotation)+qc.$.scale(this.scale)+qc.$.skew(this.skew);return this},a.position=a.position||{x:0,y:0},a.rotation=a.rotation||0,a.scale=a.scale||{x:1,y:1},a.skew=
a.skew||{x:0,y:0},a.translates=function(a,b){this.position.x=a;this.position.y=b;this.transforms();return this},a.rotate=function(a){this.rotation=a;this.transforms();return this},a.resize=function(a,b){this.scale.x=a;this.scale.y=b;this.transforms();return this},a.setSkew=function(a,b){this.skew.x=a;this.skew.y=b;this.transforms();return this};return a};
switch(qc.sys.browserType){case qc.sys.BROWSER_TYPE_FIREFOX:qc.$.pfx="Moz";qc.$.hd=!0;break;case qc.sys.BROWSER_TYPE_CHROME:case qc.sys.BROWSER_TYPE_SAFARI:qc.$.pfx="webkit";qc.$.hd=!0;break;case qc.sys.BROWSER_TYPE_OPERA:qc.$.pfx="O";qc.$.hd=!1;break;case qc.sys.BROWSER_TYPE_IE:qc.$.pfx="ms";qc.$.hd=!1;break;default:qc.$.pfx="webkit",qc.$.hd=!0}qc.$.trans=qc.$.pfx+"Transform";
qc.$.translate=qc.$.hd?function(a){return"translate3d("+a.x+"px, "+a.y+"px, 0) "}:function(a){return"translate("+a.x+"px, "+a.y+"px) "};qc.$.rotate=qc.$.hd?function(a){return"rotateZ("+a+"deg) "}:function(a){return"rotate("+a+"deg) "};qc.$.scale=function(a){return"scale("+a.x+", "+a.y+") "};qc.$.skew=function(a){return"skewX("+-a.x+"deg) skewY("+a.y+"deg)"};qc.$new=function(a){return qc.$(document.createElement(a))};
qc.$.findpos=function(a){var b=0,c=0;do b+=a.offsetLeft,c+=a.offsetTop;while(a=a.offsetParent);return{x:b,y:c}};qc.AffineTransform=function(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.d=d;this.tx=e;this.ty=f};qc.AffineTransformMake=function(a,b,c,d,e,f){return{a:a,b:b,c:c,d:d,tx:e,ty:f}};qc.PointApplyAffineTransform=function(a,b){return{x:b.a*a.x+b.c*a.y+b.tx,y:b.b*a.x+b.d*a.y+b.ty}};qc._PointApplyAffineTransform=function(a,b,c){return{x:c.a*a+c.c*b+c.tx,y:c.b*a+c.d*b+c.ty}};qc.SizeApplyAffineTransform=function(a,b){return{width:b.a*a.width+b.c*a.height,height:b.b*a.width+b.d*a.height}};
qc.AffineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}};qc.AffineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}};
qc.RectApplyAffineTransform=function(a,b){var c=qc.rectGetMinY(a),d=qc.rectGetMinX(a),e=qc.rectGetMaxX(a),f=qc.rectGetMaxY(a),g=qc._PointApplyAffineTransform(d,c,b),c=qc._PointApplyAffineTransform(e,c,b),d=qc._PointApplyAffineTransform(d,f,b),h=qc._PointApplyAffineTransform(e,f,b),e=Math.min(g.x,c.x,d.x,h.x),f=Math.max(g.x,c.x,d.x,h.x),l=Math.min(g.y,c.y,d.y,h.y),g=Math.max(g.y,c.y,d.y,h.y);return qc.rect(e,l,f-e,g-l)};
qc._RectApplyAffineTransformIn=function(a,b){var c=qc.rectGetMinY(a),d=qc.rectGetMinX(a),e=qc.rectGetMaxX(a),f=qc.rectGetMaxY(a),g=qc._PointApplyAffineTransform(d,c,b),c=qc._PointApplyAffineTransform(e,c,b),d=qc._PointApplyAffineTransform(d,f,b),h=qc._PointApplyAffineTransform(e,f,b),e=Math.min(g.x,c.x,d.x,h.x),f=Math.max(g.x,c.x,d.x,h.x),l=Math.min(g.y,c.y,d.y,h.y),g=Math.max(g.y,c.y,d.y,h.y);a.x=e;a.y=l;a.width=f-e;a.height=g-l;return a};
qc.AffineTransformTranslate=function(a,b,c){return{a:a.a,b:a.b,c:a.c,d:a.d,tx:a.tx+a.a*b+a.c*c,ty:a.ty+a.b*b+a.d*c}};qc.AffineTransformScale=function(a,b,c){return{a:a.a*b,b:a.b*b,c:a.c*c,d:a.d*c,tx:a.tx,ty:a.ty}};qc.AffineTransformRotate=function(a,b){var c=Math.sin(b),d=Math.cos(b);return{a:a.a*d+a.c*c,b:a.b*d+a.d*c,c:a.c*d-a.a*c,d:a.d*d-a.b*c,tx:a.tx,ty:a.ty}};
qc.AffineTransformConcat=function(a,b){return{a:a.a*b.a+a.b*b.c,b:a.a*b.b+a.b*b.d,c:a.c*b.a+a.d*b.c,d:a.c*b.b+a.d*b.d,tx:a.tx*b.a+a.ty*b.c+b.tx,ty:a.tx*b.b+a.ty*b.d+b.ty}};qc.AffineTransformEqualToTransform=function(a,b){return a.a===b.a&&a.b===b.b&&a.c===b.c&&a.d===b.d&&a.tx===b.tx&&a.ty===b.ty};qc.AffineTransformInvert=function(a){var b=1/(a.a*a.d-a.b*a.c);return{a:b*a.d,b:-b*a.b,c:-b*a.c,d:b*a.a,tx:b*(a.c*a.ty-a.d*a.tx),ty:b*(a.b*a.tx-a.a*a.ty)}};qc.Node=qc.Class.extend({_localZOrder:0,_position:null,_anchorPoint:null,_rotationX:0,_rotationY:0,_rotationRadiansX:0,_rotationRadiansY:0,_scaleX:1,_scaleY:1,_children:null,_visible:!0,_parent:null,tag:null,name:null,userData:null,_className:"Node",_contentSize:null,_initializedNode:!1,_running:!1,_cacheDirty:!0,_anchorPointInPoints:null,_transform:null,_skewX:0,_skewY:0,_ignoreAnchorPointForPosition:!1,_additionalTransform:null,_transformDirty:!1,_reorderChildDirty:!1,_initNode:function(){this._anchorPoint=
qc.p(0,0);this._contentSize=qc.size(0,0);this._position=qc.p(0,0);this._children=[];this._initializedNode=!0;this._anchorPointInPoints=qc.p(0,0);this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0};this._additionalTransform=qc.AffineTransformMakeIdentity();this.actionManager=qc.director.getActionManager()},ctor:function(){this._initNode()},init:function(){!1===this._initializedNode&&this._initNode();return!0},setRotation:function(a){this._rotationX=this._rotationY=a;this._rotationRadiansX=0.017453292519943295*
this._rotationX;this._rotationRadiansY=0.017453292519943295*this._rotationY;this.setNodeDirty()},setRotationX:function(a){this._rotationX=a;this._rotationRadiansX=0.017453292519943295*this._rotationX;this.setNodeDirty()},setRotationY:function(a){this._rotationY=a;this._rotationRadiansY=0.017453292519943295*this._rotationY;this.setNodeDirty()},setScale:function(a,b){this._scaleX=a;this._scaleY=b||0===b?b:a;this.setNodeDirty()},getScale:function(){return this._scaleX},getScaleX:function(){return this._scaleX},
getScaleY:function(){return this._scaleY},getRotationX:function(){return this._rotationX},getRotationY:function(){return this._rotationY},getSkewX:function(){return this._skewX},setSkewX:function(a){this._skewX=a;this.setNodeDirty()},getSkewY:function(){return this._skewY},setSkewY:function(a){this._skewY=a;this.setNodeDirty()},getPosition:function(){return qc.p(this._position)},setPosition:function(a,b){var c=this._position;void 0===b?(c.x=a.x,c.y=a.y):(c.x=a,c.y=b);this.setNodeDirty()},setNodeDirty:function(){!1===
this._transformDirty&&(this._transformDirty=this._inverseDirty=!0)},getChildrenCount:function(){return this._children.length},getChildren:function(){return this._children},isVisible:function(){return this._visible},setVisible:function(a){this._visible=a;this.setNodeDirty()},getAnchorPoint:function(){return this._anchorPoint},setAnchorPoint:function(a,b){var c=this._anchorPoint;if(void 0===b){if(a.x===c.x&&a.y===c.y)return;c.x=a.x;c.y=a.y}else{if(a===c.x&&b===c.y)return;c.x=a;c.y=b}var d=this._anchorPointInPoints,
e=this._contentSize;d.x=e.width*c.x;d.y=e.height*c.y;this.setNodeDirty()},getContentSize:function(){return this._contentSize},setContentSize:function(a,b){var c=this._contentSize;if(void 0===b){if(a.width===c.width&&a.height===c.height)return;c.width=a.width;c.height=a.height}else{if(a===c.width&&b===c.height)return;c.width=a;c.height=b}var d=this._anchorPointInPoints,e=this._anchorPoint;d.x=c.width*e.x;d.y=c.height*e.y;this.setNodeDirty()},isRunning:function(){return this._running},getParent:function(){return this._parent},
setParent:function(a){this._parent=a},getTag:function(){return this.tag},setTag:function(a){this.tag=a},getName:function(){return this.name},setName:function(a){this.name=a},getUserData:function(){return this.userData},setUserData:function(a){this.userData=a},getRotation:function(){return this._rotationX},cleanup:function(){this.stopAllActions();qc.EventManager.removeListeners(this);this._arrayMakeObjectsPerformSelector(this._children,qc.Node.StateCallbackType.cleanup)},getChildByTag:function(a){var b=
this._children;if(null!=b)for(var c=0;c<b.length;c++){var d=b[c];if(d&&d.tag==a)return d}return null},addChild:function(a,b,c){qc.assert(a,"child must be non-null");if(a===this)qc.log("An Node can't be added as a child of itself.");else if(null!==a._parent)qc.log("child already added. It can't be added again");else{var d=null!=b?b:a._localZOrder;a.tag=null!=c?c:a.tag;this._insertChild(a,d);a._parent=this;null!==b&&(this._reorderChildDirty=!0);if(this._running)a.onEnter()}},removeFromParent:function(a){this._parent&&
(null==a&&(a=!0),this._parent.removeChild(this,a))},removeChild:function(a,b){0!==this._children.length&&(null==b&&(b=!0),-1<this._children.indexOf(a)&&this._detachChild(a,b),this.setNodeDirty())},removeChildByTag:function(a,b){var c=this.getChildByTag(a);null==c?qc.log("\u6ca1\u6709\u627e\u5230tag"):this.removeChild(c,b)},removeAllChildren:function(a){var b=this._children;if(null!=b){null==a&&(a=!0);for(var c=0;c<b.length;c++){var d=b[c];d&&(this._running&&(d.onExitTransitionDidStart(),d.onExit()),
a&&d.cleanup(),d.parent=null)}this._children.length=0}},sortAllChildren:function(){if(this._reorderChildDirty){var a=this._children,b=a.length,c,d,e;for(c=1;c<b;c++){e=a[c];for(d=c-1;0<=d;){if(e._localZOrder<a[d]._localZOrder)a[d+1]=a[d];else if(e._localZOrder===a[d]._localZOrder&&e.arrivalOrder<a[d].arrivalOrder)a[d+1]=a[d];else break;d--}a[d+1]=e}this._reorderChildDirty=!1}},_detachChild:function(a,b){if(this._running)a.onExit();b&&a.cleanup();a.parent=null;qc.arrayRemoveObject(this._children,a)},
onExit:function(){this._running=!1;this.pause();this._arrayMakeObjectsPerformSelector(this._children,qc.Node.StateCallbackType.onExit)},pause:function(){this.actionManager&&this.actionManager.pauseTarget(this)},_arrayMakeObjectsPerformSelector:function(a,b){if(a&&0!==a.length){var c,d=a.length,e;c=qc.Node.StateCallbackType;switch(b){case c.onEnter:for(c=0;c<d;c++)if(e=a[c])e.onEnter();break;case c.onExit:for(c=0;c<d;c++)if(e=a[c])e.onExit();break;case c.onEnterTransitionDidFinish:for(c=0;c<d;c++)if(e=
a[c])e.onEnterTransitionDidFinish();break;case c.cleanup:for(c=0;c<d;c++)(e=a[c])&&e.cleanup();break;case c.updateTransform:for(c=0;c<d;c++)(e=a[c])&&e.updateTransform();break;case c.onExitTransitionDidStart:for(c=0;c<d;c++)if(e=a[c])e.onExitTransitionDidStart();break;case c.sortAllChildren:for(c=0;c<d;c++)(e=a[c])&&e.sortAllChildren();break;default:qc.assert(0,"\u6ca1\u6709\u8fd9\u6837\u7684type")}}},onEnter:function(){this._isTransitionFinished=!1;this._running=!0;this._arrayMakeObjectsPerformSelector(this._children,
qc.Node.StateCallbackType.onEnter);this.resume()},resume:function(){this.actionManager&&this.actionManager.resumeTarget(this)},_insertChild:function(a,b){this._children.push(a);a._setLocalZOrder(b)},setLocalZOrder:function(a){this._localZOrder=a;this._parent&&this._parent.reorderChild(this,a)},reorderChild:function(a,b){qc.assert(a,"child must be non-null");a._setLocalZOrder(b);this.setNodeDirty();this._reorderChildDirty=!0},_setLocalZOrder:function(a){this._localZOrder=a},draw:function(a){},runAction:function(a){this.actionManager.addAction(a,
this,!this._running);return a},stopAllActions:function(){this.actionManager&&this.actionManager.removeAllActionsFromTarget(this)},stopAction:function(a){this.actionManager.removeAction(a)},schedule:function(a,b,c,d){b=b||0;qc.assert(a,"\u56de\u8c03\u51fd\u6570\u662f\u7a7a");qc.assert(0<=b,"\u95f4\u9694\u65f6\u95f4\u5fc5\u987b\u5927\u4e8e0")},unscheduleAllCallbacks:function(){},update:function(a){},visit:function(a){if(this._visible){a=a||qc._renderContext;var b,c=this._children,d;a.save();this.transform(a);
var e=c.length;if(0<e){this.sortAllChildren();for(b=0;b<e;b++)if(d=c[b],0>d._localZOrder)d.visit(a);else break;for(this.draw(a);b<e;b++)c[b].visit(a)}else this.draw(a);this._cacheDirty=!1;this.arrivalOrder=0;a.restore()}},transform:function(a){a=a||qc._renderContext;a.translate(this._position.x,-this._position.y);a.scale(this._scaleX,this._scaleY);a.rotate(this._rotationRadiansX)},isIgnoreAnchorPointForPosition:function(){return this._ignoreAnchorPointForPosition},ignoreAnchorPointForPosition:function(a){a!=
this._ignoreAnchorPointForPosition&&(this._ignoreAnchorPointForPosition=a,this.setNodeDirty())},setAdditionalTransform:function(a){this._additionalTransform=a;this._additionalTransformDirty=this._transformDirty=!0},nodeToParentTransform:function(){if(this._transformDirty){var a=this._transform;a.tx=this._position.x;a.ty=this._position.y;var b=1,c=0;this._rotationX&&(b=Math.cos(this._rotationRadiansX),c=Math.sin(this._rotationRadiansX));a.a=a.d=b;a.b=-c;a.c=c;var d=this._scaleX,e=this._scaleY,f=this._anchorPointInPoints.x,
g=this._anchorPointInPoints.y,h=1E-6>d&&-1E-6<d?1E-6:d,l=1E-6>e&&-1E-6<e?1E-6:e;if(this._skewX||this._skewY){var k=Math.tan(-this._skewX*Math.PI/180),m=Math.tan(-this._skewY*Math.PI/180);Infinity===k&&(k=99999999);Infinity===m&&(m=99999999);var n=g*k*h,r=f*m*l;a.a=b+-c*m;a.b=b*k+-c;a.c=c+b*m;a.d=c*k+b;a.tx+=b*n+-c*r;a.ty+=c*n+b*r}if(1!==d||1!==e)a.a*=h,a.c*=h,a.b*=l,a.d*=l;a.tx+=b*-f*h+-c*g*l;a.ty-=c*-f*h+b*g*l;this._ignoreAnchorPointForPosition&&(a.tx+=f,a.ty+=g);this._additionalTransformDirty&&
(this._transform=qc.AffineTransformConcat(a,this._additionalTransform),this._additionalTransformDirty=!1);this._transformDirty=!1}return this._transform}});qc.Node.StateCallbackType={onEnter:1,onExit:2,cleanup:3,onEnterTransitionDidFinish:4,updateTransform:5,onExitTransitionDidStart:6,sortAllChildren:7};qc.Node.create=function(){return new qc.Node};qc.Scene=qc.Node.extend({_className:"Scene",ctor:function(){qc.Node.prototype.ctor.call(this);this._ignoreAnchorPointForPosition=!0;this.setAnchorPoint(0.5,0.5);this.setContentSize(qc.director.getWinSize())}});qc.Scene.create=function(){return new qc.Scene};qc.Sprite=qc.Node.extend({_loadedEventListeners:null,_rect:null,_rectRotated:!1,addLoadedEventListener:function(a,b){this._loadedEventListeners||(this._loadedEventListeners=[]);this._loadedEventListeners.push({eventCallback:a,eventTarget:b})},_callLoadedEventCallbacks:function(){if(this._loadedEventListeners){for(var a=this._loadedEventListeners,b=0,c=a.length;b<c;b++){var d=a[b];d.eventCallback.call(d.eventTarget,this)}a.length=0}},isTextureRectRotated:function(){return this._rectRotated},getTextureRect:function(){return qc.rect(this._rect.x,
this._rect.y,this._rect.width,this._rect.height)},sortAllChildren:function(){if(this._reorderChildDirty){var a=this._children,b=a.length,c,d,e;for(c=1;c<b;c++){e=a[c];for(d=c-1;0<=d;){if(e._localZOrder<a[d]._localZOrder)a[d+1]=a[d];else if(e._localZOrder===a[d]._localZOrder&&e.arrivalOrder<a[d].arrivalOrder)a[d+1]=a[d];else break;d--}a[d+1]=e}this._reorderChildDirty=!1}},initWithFile:function(a,b){qc.assert(a,"\u628a\u6587\u4ef6\u540d\u4f20\u8fdb\u6765\u554a");var c=qc.textureCache.textureForKey(a);
if(c){if(!b){var d=c.getContentSize();b=qc.rect(0,0,d.width,d.height)}return this.initWithTexture(c,b)}c=qc.textureCache.addImage(a);return this.initWithTexture(c,b||qc.rect(0,0,c._contentSize.width,c._contentSize.height))},_textureLoadedCallback:function(a){if(!this._textureLoaded){this._textureLoaded=!0;var b=this._rect;b?qc._rectEqualToZero(b)&&(b.width=a.width,b.height=a.height):b=qc.rect(0,0,a.width,a.height);this._texture=this.texture=a;this.setTextureRect(b,this._rectRotated);this._callLoadedEventCallbacks()}},
init:function(){if(0<arguments.length)return this.initWithFile(arguments[0],arguments[1]);qc.Node.prototype.init.call(this);this.texture=null;this._textureLoaded=!0;this._anchorPoint=qc.p(0.5,0.5);this.setTextureRect(qc.rect(0,0,0,0),!1,qc.size(0,0));return!0},initWithTexture:function(a,b,c){if((c=c||!1)&&a.isLoaded()){a=a.getHtmlElementObj();a=qc.cutRotateImageToCanvas(a,b);var d=new qc.Texture2D;d.initWithElement(a);d.handleLoadedTexture();a=d;this._rect=qc.rect(0,0,b.width,b.height)}if(!qc.Node.prototype.init.call(this))return!1;
this._anchorPoint=qc.p(0.5,0.5);this._textureLoaded=d=a.isLoaded();if(!d)return this._rectRotated=c,b&&(this._rect.x=b.x,this._rect.y=b.y,this._rect.width=b.width,this._rect.height=b.height),a.addLoadedEventListener(this._textureLoadedCallback,this),!0;b||(b=qc.rect(0,0,a.width,a.height));a&&(d=b.y+b.height,b.x+b.width>a.width&&qc.error("\u8d85\u51fa\u8fb9\u754c",a.url),d>a.height&&qc.error("\u8d85\u51fa\u8fb9\u754c",a.url));this._texture=this.texture=this._originalTexture=a;this.setTextureRect(b,
c);return!0},initWithSpriteFrame:function(a){var b=a._rotated,b=this.initWithTexture(a.getTexture(),a.getRect(),b);this.setSpriteFrame(a);return b},setSpriteFrame:function(a){var b=a.getTexture(),c=a.getRect();a=a.isRotated();this._texture!=b&&(this.texture=this._texture=b);this.setTextureRect(c,a)},setTextureRect:function(a,b,c){this._rectRotated=b||!1;b=this._textureRect_Canvas;b.x=0|a.x;b.y=0|a.y;b.width=0|a.width;b.height=0|a.height;this._rect=this._textureRect_Canvas;this.setContentSize(c||a)},
_softInit:function(a,b,c){void 0===a?qc.Sprite.prototype.init.call(this):"string"===typeof a?"#"===a[0]?a.substr(1,a.length-1):qc.Sprite.prototype.init.call(this,a,b):"object"===typeof a&&this.initWithSpriteFrame(a)},ctor:function(a,b,c){qc.Node.prototype.ctor.call(this);this._rect=qc.rect(0,0,0,0);this._textureLoaded=!0;this._textureRect_Canvas={x:0,y:0,width:0,height:0,validRect:!1};this._softInit(a,b,c)},draw:function(a){if(this._textureLoaded){a=a||qc._renderContext;var b=this._textureRect_Canvas,
c=this._anchorPoint,c=qc.p(c.x*b.width,c.y*b.height),c=qc.rect(-c.x,-b.height+c.y,b.width,b.height);if(this._texture){var d=this._texture.getHtmlElementObj();a.drawImage(d,b.x,b.y,b.width,b.height,c.x,c.y,c.width,c.height)}qc.g_NumberOfDraws++}},getDrawRect:function(){var a=this._textureRect_Canvas,b=this._anchorPoint,b=qc.p(b.x*a.width,b.y*a.height);return qc.rect(-b.x,-b.y,a.width,a.height)},isContain:function(a){var b=this.getDrawRect(),c=this.getPosition(),d=c.x+b.x,e=d+b.width,c=c.y+b.y,b=c+
b.height;return a.x>d&&a.x<e&&a.y>c&&a.y<b?!0:!1}});qc.Sprite.create=function(a,b,c){return new qc.Sprite(a,b,c)};qc.cutRotateImageToCanvas=function(a,b){if(!a)return null;if(!b)return a;var c=qc.newElement("canvas");c.width=b.width;c.height=b.height;var d=c.getContext("2d");d.translate(c.width/2,c.height/2);d.rotate(-1.5707963267948966);d.drawImage(a,b.x,b.y,b.height,b.width,-b.height/2,-b.width/2,b.height,b.width);return c};qc.SpriteFrame=qc.Class.extend({_rect:null,_texture:null,_rotated:!1,ctor:function(){},initWithTexture:function(a,b,c){this._rect=b;this._texture=this.texture=a;this._rotated=c||!1;return!0},initWithFile:function(a,b){qc.assert(a,"\u628a\u6587\u4ef6\u540d\u4f20\u8fdb\u6765\u554a");var c=qc.textureCache.textureForKey(a);if(c){if(!b){var d=c.getContentSize();b=qc.rect(0,0,d.width,d.height)}return this.initWithTexture(c,b)}c=qc.textureCache.addImage(a);return this.initWithTexture(c,b||qc.rect(0,0,c._contentSize.width,
c._contentSize.height))},setTexture:function(a){this._texture=a},getTexture:function(){return this._texture},getRect:function(){return this._rect},setRect:function(a){this._rect=a},isRotated:function(){return this._rotated}});qc.SpriteFrame.create=function(a,b,c){var d=new qc.SpriteFrame;d.initWithTexture(a,b,c);return d};qc.SpriteFrame.createWithFile=function(a){var b=new qc.SpriteFrame;b.initWithFile(a);return b};qc.SpriteFrameCache=qc.Class.extend({_CCNS_REG1:/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,_CCNS_REG2:/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,_spriteFrames:null,_frameConfigCache:null,ctor:function(){this._spriteFrames=[];this._frameConfigCache=[]},_getFrameConfig:function(a){var b=qc.loader.getRes(a);qc.loader.release(a);if(b._inited)return this._frameConfigCache[a]=b;var c=b.frames,d=b.metadata||
b.meta,b={},e={},f=0;d&&(f=d.format,f=1>=f.length?parseInt(f):f,e.image=d.textureFileName||d.textureFileName||d.image);for(var g in c){var h=c[g];if(h){d={};if(0==f){d.rect=qc.rect(h.x,h.y,h.width,h.height);d.rotated=!1;d.offset=qc.p(h.offsetX,h.offsetY);var l=h.originalWidth,h=h.originalHeight;l&&h||qc.log("\u5728 qcspriteFrameCache 37\u884c");l=Math.abs(l);h=Math.abs(h);d.size=qc.size(l,h)}else if(1==f||2==f)d.rect=this._rectFromString(h.frame),d.rotated=h.rotated||!1,d.offset=this._pointFromString(h.offset),
d.size=this._sizeFromString(h.sourceSize);else if(3==f){var l=this._sizeFromString(h.spriteSize),k=this._rectFromString(h.textureRect);l&&(k=qc.rect(k.x,k.y,l.width,l.height));d.rect=k;d.rotated=h.textureRotated||!1;d.offset=this._pointFromString(h.spriteOffset);d.size=this._sizeFromString(h.spriteSourceSize);d.aliases=h.aliases}else l=h.frame,k=h.sourceSize,g=h.filename||g,d.rect=qc.rect(l.x,l.y,l.w,l.h),d.rotated=h.rotated||!1,d.offset=qc.p(0,0),d.size=qc.size(k.w,k.h);b[g]=d}}return this._frameConfigCache[a]=
{_inited:!0,frames:b,meta:e}},_rectFromString:function(a){return(a=this._CCNS_REG2.exec(a))?qc.rect(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]),parseFloat(a[4])):qc.rect(0,0,0,0)},_sizeFromString:function(a){return(a=this._CCNS_REG1.exec(a))?qc.size(parseFloat(a[1]),parseFloat(a[2])):qc.size(0,0)},_pointFromString:function(a){return(a=this._CCNS_REG1.exec(a))?qc.p(parseFloat(a[1]),parseFloat(a[2])):qc.p(0,0)},addSpriteFrames:function(a,b){var c=this._frameConfigCache[a]||qc.loader.getRes(a);
if(c&&c.frames){c=(this._frameConfigCache[a]||this._getFrameConfig(a)).frames;b=qc.textureCache.addImage(b);var d=this._spriteFrames,e;for(e in c){var f=c[e],g=d[e];if(!g){g=qc.SpriteFrame.create(b,f.rect,f.rotated);if(g.isRotated()&&g.getTexture().isLoaded()){var f=g.getTexture().getHtmlElementObj(),f=qc.cutRotateImageToCanvas(f,g.getRect()),h=new qc.Texture2D;h.initWithElement(f);h.handleLoadedTexture();g.setTexture(h);f=g._rect;g.setRect(qc.rect(0,0,f.width,f.height))}d[e]=g}}}},addSpriteFrame:function(a,
b){this._spriteFrames[a]=b},getSpriteFrame:function(a){return this._spriteFrames[a]}});qc.SpriteFrameCache._instance=null;qc.SpriteFrameCache._getInstance=function(){null==qc.SpriteFrameCache._instance&&(qc.SpriteFrameCache._instance=new qc.SpriteFrameCache);return qc.SpriteFrameCache._instance};qc.SAXParser=qc.Class.extend({_parser:null,_isSupportDOMParser:null,ctor:function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):this._isSupportDOMParser=!1},parse:function(a){return this._parseXML(a)},_parseXML:function(a){var b;this._isSupportDOMParser?b=this._parser.parseFromString(a,"text/xml"):(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a));return b}});
qc.PlistParser=qc.SAXParser.extend({parse:function(a){a=this._parseXML(a).documentElement;if("plist"!=a.tagName)throw"Not a plist file!";for(var b=null,c=0,d=a.childNodes.length;c<d&&(b=a.childNodes[c],1!=b.nodeType);c++);return this._parseNode(b)},_parseNode:function(a){var b=null,c=a.tagName;if("dict"==c)b=this._parseDict(a);else if("array"==c)b=this._parseArray(a);else if("string"==c)if(1==a.childNodes.length)b=a.firstChild.nodeValue;else for(b="",c=0;c<a.childNodes.length;c++)b+=a.childNodes[c].nodeValue;
else"false"==c?b=!1:"true"==c?b=!0:"real"==c?b=parseFloat(a.firstChild.nodeValue):"integer"==c&&(b=parseInt(a.firstChild.nodeValue,10));return b},_parseArray:function(a){for(var b=[],c=0,d=a.childNodes.length;c<d;c++){var e=a.childNodes[c];1==e.nodeType&&b.push(this._parseNode(e))}return b},_parseDict:function(a){for(var b={},c=null,d=0,e=a.childNodes.length;d<e;d++){var f=a.childNodes[d];1==f.nodeType&&("key"==f.tagName?c=f.firstChild.nodeValue:b[c]=this._parseNode(f))}return b}});
qc.plistParser=new qc.PlistParser;qc.Layer=qc.Node.extend({_isBaked:!1,_bakeSprite:null,_className:"Layer",ctor:function(){var a=qc.Node.prototype;a.ctor.call(this);this._ignoreAnchorPointForPosition=!0;a.setAnchorPoint.call(this,0.5,0.5);a.setContentSize.call(this,qc.winSize)},bake:null,unbake:null,isBaked:function(){return this._isBaked},visit:function(a){this._isBaked||qc.Node.prototype.visit.call(this,a)},translateToLayer:function(a){var b=this.getPosition();return qc.p(a.x-b.x,a.y-b.y)}});qc.Layer.create=function(){return new qc.Layer};qc.Texture2D=qc.Class.extend({_contentSize:null,_isLoaded:!1,_htmlElementObj:null,_loadedEventListeners:null,url:null,ctor:function(){this._contentSize=qc.size(0,0);this._isLoaded=!1;this._htmlElementObj=null},initWithElement:function(a){a&&(this._htmlElementObj=a)},getContentSize:function(){return this._contentSize},handleLoadedTexture:function(){if(!this._isLoaded){if(!this._htmlElementObj){var a=qc.loader.getRes(this.url);if(!a)return;this.initWithElement(a)}this._isLoaded=!0;a=this._htmlElementObj;
this._contentSize.width=a.width;this._contentSize.height=a.height;this._callLoadedEventCallbacks()}},releaseTexture:function(){},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._isLoaded},addLoadedEventListener:function(a,b){this._loadedEventListeners||(this._loadedEventListeners=[]);this._loadedEventListeners.push({eventCallback:a,eventTarget:b})},removeLoadedEventListener:function(a){if(this._loadedEventListeners)for(var b=this._loadedEventListeners,c=0;c<
b.length;c++)b[c].eventTarget==a&&b.splice(c,1)},_callLoadedEventCallbacks:function(){if(this._loadedEventListeners){for(var a=this._loadedEventListeners,b=0,c=a.length;b<c;b++){var d=a[b];d.eventCallback.call(d.eventTarget,this)}a.length=0}}});qc.textureCache={_textures:{},textureForKey:function(a){return this._textures[a]},getKeyByTexture:function(a){for(var b in this._textures)if(this._textures[b]==a)return b;return null},removeTexture:function(a){if(a){var b=this._textures,c;for(c in b)b[c]==a&&(b[c].releaseTexture(),delete b[c])}},removeTextureForKey:function(a){null!=a&&this._textures[a]&&delete this._textures[a]},cacheImage:function(a,b){if(b instanceof qc.Texture2D)this._textures[a]=b;else{var c=new qc.Texture2D;c.initWithElement(b);
c.handleLoadedTexture();this._textures[a]=c}},addImage:function(a,b,c){var d=this._textures,e=d[a];if(e)return b&&b.call(c),e;e=d[a]=new qc.Texture2D;e.url=a;qc.loader.getRes(a)?e.handleLoadedTexture():qc.loader._checkIsImageURL(a)?qc.loader.load(a,function(a){b&&b.call(c)}):qc.loader.cache[a]=qc.loader.loadImg(a,function(c,d){if(c)return b?b(c):c;qc.textureCache.handleLoadedTexture(a);b&&b(null,d)});return e},handleLoadedTexture:function(a){var b=this._textures,c=b[a];c||(c=b[a]=new qc.Texture2D,
c.url=a);c.handleLoadedTexture()},_clear:function(){this._textures={};this._textureColorsCache={};this._textureKeySeq=0|1E3*Math.random();this._loadedTexturesBefore={}}};qc._txtLoader={load:function(a,b,c,d){qc.loader.loadTxt(a,d)}};qc.loader.register(["txt","xml","vsh","fsh","atlas"],qc._txtLoader);qc._jsonLoader={load:function(a,b,c,d){qc.loader.loadJson(a,d)}};qc.loader.register(["json","ExportJson"],qc._jsonLoader);qc._imgLoader={load:function(a,b,c,d){qc.loader.cache[b]=qc.loader.loadImg(a,function(a,c){if(a)return d(a);qc.textureCache.handleLoadedTexture(b);d(null,c)})}};qc.loader.register("png jpg bmp jpeg gif ico".split(" "),qc._imgLoader);
qc._plistLoader={load:function(a,b,c,d){qc.loader.loadTxt(a,function(a,b){if(a)return d(a);d(null,qc.plistParser.parse(b))})}};qc.loader.register(["plist"],qc._plistLoader);qc.Touch=qc.Class.extend({_point:null,_prevPoint:null,_id:0,_startPointCaptured:!1,_startPoint:null,ctor:function(a,b,c){this._point=qc.p(a||0,b||0);this._id=c||0},getLocation:function(){return{x:this._point.x,y:this._point.y}},getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},getPreviousLocation:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocation:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getLocationInView:function(){return{x:this._point.x,
y:this._point.y}},getPreviousLocationInView:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocationInView:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getID:function(){return this._id},getId:function(){return this._id},setTouchInfo:function(a,b,c){this._prevPoint=this._point;this._point=qc.p(b||0,c||0);this._id=a;this._startPointCaptured||(this._startPoint=qc.p(this._point),this._startPointCaptured=!0)},_setPoint:function(a,b){void 0===b?(this._point.x=a.x,this._point.y=
a.y):(this._point.x=a,this._point.y=b)}});qc.Event=qc.Class.extend({_type:0,_isStopped:!1,_currentTarget:null,_setCurrentTarget:function(a){this._currentTarget=a},ctor:function(a){this._type=a},getType:function(){return this._type},stopPropagation:function(){this._isStopped=!0},isStopped:function(){return this._isStopped},getCurrentTarget:function(){return this._currentTarget}});
qc.EventTouch=qc.Event.extend({_eventCode:0,_touches:null,ctor:function(a){qc.Event.prototype.ctor.call(this,qc.Event.TOUCH);this._touches=a||[]},getEventCode:function(){return this._eventCode},getTouches:function(){return this._touches},_setEventCode:function(a){this._eventCode=a},_setTouches:function(a){this._touches=a}});qc.Event.TOUCH=0;qc.EventTouch.EventCode={BEGAN:0,MOVED:1,ENDED:2,CANCELLED:3};qc.EventListener=qc.Class.extend({_onEvent:null,_type:0,_registered:!1,_node:null,_paused:!1,_isEnabled:!0,ctor:function(a,b){this._onEvent=b;this._type=a||0},_setPaused:function(a){this._paused=a},_isPaused:function(){return this._paused},_setRegistered:function(a){this._registered=a},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_setSceneGraphPriority:function(a){this._node=a},_getSceneGraphPriority:function(){return this._node},checkAvailable:function(){return null!=
this._onEvent},clone:function(){return null},setEnabled:function(a){this._isEnabled=a},isEnabled:function(){return this._isEnabled}});
qc._EventListenerTouchOneByOne=qc.EventListener.extend({_claimedTouches:null,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,ctor:function(){qc.EventListener.prototype.ctor.call(null,null);this._claimedTouches=[]},clone:function(){var a=new qc._EventListenerTouchOneByOne;a.onTouchBegan=this.onTouchBegan;a.onTouchMoved=this.onTouchMoved;a.onTouchEnded=this.onTouchEnded;a.onTouchCancelled=this.onTouchCancelled;a.swallowTouches=this.swallowTouches;return a},checkAvailable:function(){return this.onTouchBegan?
!0:!1}});qc.EventListener.TOUCH_ONE_BY_ONE=0;qc.EventListener.create=function(a){var b=new qc._EventListenerTouchOneByOne,c;for(c in a)b[c]=a[c];return b};qc.EventManager={_listeners:[],_isEnabled:!0,addListener:function(a,b){if(!(a instanceof qc.EventListener))a=qc.EventListener.create(a);else if(a._isRegistered())return;a.checkAvailable()&&("number"!=typeof b&&(a._setPaused(!1),a.setEnabled(!0),a._setRegistered(!0),a._setSceneGraphPriority(b)),this._listeners.push(a))},removeListener:function(a){qc.log(a);if(null!=a)for(var b=this._listeners,c=b.length,d=0;d<c;d++)if(a==b[d]){b.splice(d,1);break}},dispatchEvent:function(a){if(this._isEnabled){if(!a||
!a.getType)throw"event is undefined";a.getType()==qc.Event.TOUCH&&this._dispatchTouchEvent(a)}},_dispatchTouchEvent:function(a){var b=this._listeners,c=a.getTouches(),d={event:a,touches:c,selTouch:null};if(b)for(var e=0;e<c.length&&(d.selTouch=c[e],this._dispatchEventToListeners(b,this._onTouchEventCallback,d),!a.isStopped());e++);},_dispatchEventToListeners:function(a,b,c){for(var d=a.length,e=0;e<d;e++){var f=a[e];if(f.isEnabled()&&!f._isPaused()&&f._isRegistered()&&b(f,c))break}},_onTouchEventCallback:function(a,
b){if(!a._isRegistered)return!1;var c=b.event,d=b.selTouch;c._setCurrentTarget(a._node);var e=c.getEventCode(),f=qc.EventTouch.EventCode;if(e==f.BEGAN){if(a.onTouchBegan)a.onTouchBegan(d,c)}else if(e===f.MOVED&&a.onTouchMoved)a.onTouchMoved(d,c);else if(e===f.ENDED&&a.onTouchEnded)a.onTouchEnded(d,c);return c.isStopped()?!0:!1},handleTouchesBegin:function(a){a=new qc.EventTouch(a);a._eventCode=qc.EventTouch.EventCode.BEGAN;this.dispatchEvent(a)},handleTouchesEnd:function(a){0<a.length&&(a=new qc.EventTouch(a),
a._eventCode=qc.EventTouch.EventCode.ENDED,this.dispatchEvent(a))},handleTouchesMove:function(a){0<a.length&&(a=new qc.EventTouch(a),a._eventCode=qc.EventTouch.EventCode.MOVED,this.dispatchEvent(a))},getHTMLElementPosition:function(a){var b=document.documentElement,c=window,d=null,d="function"===typeof a.getBoundingClientRect?a.getBoundingClientRect():a instanceof HTMLCanvasElement?{left:0,top:0,width:a.width,height:a.height}:{left:0,top:0,width:parseInt(a.style.width),height:parseInt(a.style.height)};
return{left:d.left+c.pageXOffset-b.clientLeft,top:d.top+c.pageYOffset-b.clientTop,width:d.width,height:d.height}},getPointByEvent:function(a,b){if(null!=a.pageX)return{x:a.pageX,y:a.pageY};b.left-=document.body.scrollLeft;b.top-=document.body.scrollTop;return{x:a.clientX,y:a.clientY}},getTouchByXY:function(a,b,c){a=this.convertToLocationInView(a,b,c);return new qc.Touch(a.x,a.y)},convertToLocationInView:function(a,b,c){var d=qc.director.getWinSize(),e=c.height;return{x:(a-c.left)/c.width*d.width,
y:(c.top+e-b)/e*d.height}},registerSystemEvent:function(a){var b=this,c="touches"in qc.sys.capabilities;"mouse"in qc.sys.capabilities&&(qc._addEventListener(a,"mousedown",function(d){b._mousePressed=!0;var e=b.getHTMLElementPosition(a),f=b.getPointByEvent(d,e);c||b.handleTouchesBegin([b.getTouchByXY(f.x,f.y,e)]);d.stopPropagation();d.preventDefault();a.focus()},!1),qc._addEventListener(a,"mouseup",function(d){b._mousePressed=!1;var e=b.getHTMLElementPosition(a),f=b.getPointByEvent(d,e);c||b.handleTouchesEnd([b.getTouchByXY(f.x,
f.y,e)]);d.stopPropagation();d.preventDefault()},!1),qc._addEventListener(a,"mousemove",function(d){var e=b.getHTMLElementPosition(a),f=b.getPointByEvent(d,e);!c&&b._mousePressed&&b.handleTouchesMove([b.getTouchByXY(f.x,f.y,e)]);d.stopPropagation();d.preventDefault()},!1));c&&(qc._addEventListener(a,"touchstart",function(c){qc.log("touchstart");if(c.changedTouches){var e=b.getHTMLElementPosition(a);e.left-=document.body.scrollLeft;e.top-=document.body.scrollTop;b.handleTouchesBegin(b.getTouchesByEvent(c,
e));c.stopPropagation();c.preventDefault();a.focus()}},!1),qc._addEventListener(a,"touchmove",function(c){qc.log("touchstart");if(c.changedTouches){var e=b.getHTMLElementPosition(a);e.left-=document.body.scrollLeft;e.top-=document.body.scrollTop;b.handleTouchesMove(b.getTouchesByEvent(c,e));c.stopPropagation();c.preventDefault()}},!1),qc._addEventListener(a,"touchend",function(c){if(c.changedTouches){var e=b.getHTMLElementPosition(a);e.left-=document.body.scrollLeft;e.top-=document.body.scrollTop;
b.handleTouchesEnd(b.getTouchesByEvent(c,e));c.stopPropagation();c.preventDefault()}},!1))},removeListeners:function(a){a=a.__instanceId;for(var b=this._listeners,c=0;c<b.length;c++){var d=b[c];d._node.__instanceId==a&&(d.setEnabled(!1),d._setRegistered(!1),b.splice(c,1),c--)}},isChildOfParent:function(a,b){if(null==a)return!1;if(a.__instanceId!=b)return this.isChildOfParent(a.getParent(),b)},getTouchesByEvent:function(a,b){for(var c=[],d,e=a.changedTouches.length,f=0;f<e;f++)if(d=a.changedTouches[f]){var g;
g=qc.sys.BROWSER_TYPE_FIREFOX===qc.sys.browserType?this.convertToLocationInView(d.pageX,d.pageY,b):this.convertToLocationInView(d.clientX,d.clientY,b);d=null!=d.identifier?new qc.Touch(g.x,g.y,d.identifier):new qc.Touch(g.x,g.y);c.push(d)}return c}};qc.Action=qc.Class.extend({originalTarget:null,target:null,tag:1,_duration:null,ctor:function(){this.target=this.originalTarget=null;this.tag=qc.ACTION_TAG_INVALID},isDone:function(){return!0},startWithTarget:function(a){this.target=this.originalTarget=a},stop:function(){this.target=null},step:function(a){qc.log("[Action step]. override me")},update:function(a){qc.log("[Action update]. override me")},getTarget:function(){return this.target},setTarget:function(a){this.target=a},getOriginalTarget:function(){return this.originalTarget},
setOriginalTarget:function(a){this.originalTarget=a},getTag:function(){return this.tag},setTag:function(a){this.tag=a}});qc.ScaleTo=qc.Action.extend({_desScaleX:null,_desScaleY:null,_isDone:!1,speedX:0,speedY:0,timesum:0,ctor:function(a,b,c){this._super();this._desScaleX=b;this._desScaleY=c||b;this._duration=a},startWithTarget:function(a){this._super(a);var b=a.getScaleX();a=a.getScaleY();this.speedX=(this._desScaleX-b)/this._duration;this.speedY=(this._desScaleY-a)/this._duration;this.timesum=0;this._isDone=!1},step:function(a){this.timesum+=a;var b,c=this.target;b=c.getScaleX();c=c.getScaleY();b+=this.speedX*a;a=
c+this.speedY*a;this.timesum>=this._duration&&(this._isDone=!0,b=this._desScaleX,a=this._desScaleY);this.target.setScale(b,a)},isDone:function(){return this._isDone}});qc.ScaleTo.create=function(a,b,c){return new qc.ScaleTo(a,b,c)};qc.HashElement=qc.Class.extend({actions:null,target:null,actionIndex:0,currentAction:null,currentActionSalvaged:!1,paused:!1,hh:null,ctor:function(){this.actions=[];this.target=null;this.actionIndex=0;this.currentAction=null;this.paused=this.currentActionSalvaged=!1;this.hh=null}});
qc.ActionManager=qc.Class.extend({_hashTargets:null,_arrayTargets:null,_currentTarget:null,_currentTargetSalvaged:!1,_searchElementByTarget:function(a,b){for(var c=0;c<a.length;c++)if(b==a[c].target)return a[c];return null},ctor:function(){this._hashTargets={};this._arrayTargets=[];this._currentTarget=null;this._currentTargetSalvaged=!1},addAction:function(a,b,c){if(!a)throw"qc.ActionManager.addAction(): action must be non-null";if(!b)throw"qc.ActionManager.addAction(): action must be non-null";var d=
this._hashTargets[b.__instanceId];d||(d=new qc.HashElement,d.paused=c,d.target=b,this._hashTargets[b.__instanceId]=d,this._arrayTargets.push(d));this._actionAllocWithHashElement(d);d.actions.push(a);a.startWithTarget(b)},removeAllActions:function(){for(var a=this._arrayTargets,b=0;b<a.length;b++){var c=a[b];c&&this.removeAllActionsFromTarget(c.target,!0)}},removeAllActionsFromTarget:function(a,b){if(null!=a){var c=this._hashTargets[a.__instanceId];c&&(-1===c.actions.indexOf(c.currentAction)||c.currentActionSalvaged||
(c.currentActionSalvaged=!0),c.actions.length=0,this._currentTarget!=c||b?this._deleteHashElement(c):this._currentTargetSalvaged=!0)}},removeAction:function(a){if(null!=a){var b=a.getOriginalTarget();if(b=this._hashTargets[b.__instanceId])for(var c=0;c<b.actions.length;c++){if(b.actions[c]==a){b.actions.splice(c,1);break}}else qc.log(qc._LogInfos.ActionManager_removeAction)}},removeActionByTag:function(a,b){var c=this._hashTargets[b.__instanceId];if(c)for(var d=c.actions.length,e=0;e<d;++e){var f=
c.actions[e];if(f&&f.getTag()===a&&f.getOriginalTarget()==b){this._removeActionAtIndex(e,c);break}}},getActionByTag:function(a,b){var c=this._hashTargets[b.__instanceId];if(c&&null!=c.actions)for(var d=0;d<c.actions.length;++d){var e=c.actions[d];if(e&&e.getTag()===a)return e}return null},numberOfRunningActionsInTarget:function(a){return(a=this._hashTargets[a.__instanceId])?a.actions?a.actions.length:0:0},pauseTarget:function(a){if(a=this._hashTargets[a.__instanceId])a.paused=!0},resumeTarget:function(a){if(a=
this._hashTargets[a.__instanceId])a.paused=!1},pauseAllRunningActions:function(){for(var a=[],b=this._arrayTargets,c=0;c<b.length;c++){var d=b[c];d&&!d.paused&&(d.paused=!0,a.push(d.target))}return a},resumeTargets:function(a){if(a)for(var b=0;b<a.length;b++)a[b]&&this.resumeTarget(a[b])},purgeSharedManager:function(){},_removeActionAtIndex:function(a,b){b.actions[a]!=b.currentAction||b.currentActionSalvaged||(b.currentActionSalvaged=!0);b.actions.splice(a,1);b.actionIndex>=a&&b.actionIndex--;0==
b.actions.length&&(this._currentTarget==b?this._currentTargetSalvaged=!0:this._deleteHashElement(b))},_deleteHashElement:function(a){a&&(delete this._hashTargets[a.target.__instanceId],qc.arrayRemoveObject(this._arrayTargets,a),a.actions=null,a.target=null)},_actionAllocWithHashElement:function(a){null==a.actions&&(a.actions=[])},update:function(a){for(var b=this._arrayTargets,c,d=0;d<b.length;d++){c=this._currentTarget=b[d];if(!c.paused)for(c.actionIndex=0;c.actionIndex<c.actions.length;c.actionIndex++)if(c.currentAction=
c.actions[c.actionIndex],c.currentAction){c.currentActionSalvaged=!1;c.currentAction.step(a*(c.currentAction._speedMethod?c.currentAction._speed:1));if(c.currentActionSalvaged)c.currentAction=null;else if(c.currentAction.isDone()){c.currentAction.stop();var e=c.currentAction;c.currentAction=null;this.removeAction(e)}c.currentAction=null}this._currentTargetSalvaged&&0===c.actions.length&&this._deleteHashElement(c)}}});qc.ActionManager.shareAcitonManager=null;qc.ActionManager.firstUseManager=!0;
qc.ActionManager._getInstance=function(){null==qc.ActionManager.shareAcitonManager&&(qc.ActionManager.firstUseManager=!1,qc.ActionManager.shareAcitonManager=new qc.ActionManager);return qc.ActionManager.shareAcitonManager};qc.Animation=qc.Class.extend({_frames:null,_delay:null,_loops:null,_currentIndex:null,_count:0,ctor:function(a,b,c){this._frames=a;this._delay=b;this._loops=c;this._currentIndex=-1;this._count=0},getLoops:function(){return this._loops},getDelay:function(){return this._delay},getFrames:function(){return this._frames},addFrame:function(a){this._frames.push(a)},removeFrameByIndex:function(a){a<this._frames.length-1&&0<=a&&this._frames.splice(a,1)},getNextFrame:function(){this._currentIndex++;return this._currentIndex>=
this._frames.length&&(this._currentIndex=0,this._count++,this._loops&&this._count>=this._loops)?null:this._frames[this._currentIndex]}});qc.Animation.create=function(a,b,c){return new qc.Animation(a,b,c)};qc.Animate=qc.Action.extend({_isDone:!1,_animation:null,_delay:null,_timeSum:0,ctor:function(a){this._super();this._animation=a;this._delay=a.getDelay()},startWithTarget:function(a){this._super(a);this._timeSum=0;this._isDone=!1},step:function(a){this._timeSum+=a;this._timeSum>this._delay&&(a=this._animation.getNextFrame(),null==a?this._isDone=!0:(this.target.setSpriteFrame(a),this._timeSum-=parseInt(this._timeSum/this._delay)*this._delay))},isDone:function(){return this._isDone}});
qc.Animate.create=function(a){return new qc.Animate(a)};qc.CallFunc=qc.Action.extend({callBack:null,callTarget:null,_isDone:!1,ctor:function(a,b){this._super();this.callBack=a;this.callTarget=b;this._duration=0},startWithTarget:function(a){this._super(a);this.callBack.call(this.callTarget);this._isDone=!0},step:function(a){},isDone:function(){return this._isDone}});qc.CallFunc.create=function(a,b){return new qc.CallFunc(a,b)};qc.MoveTo=qc.Action.extend({desPos:null,startPos:null,allTime:0,speedX:0,speedY:0,_isDone:!1,ctor:function(a,b){this._super();this._duration=a;this.desPos=b},startWithTarget:function(a){this._super(a);this._isDone=!1;this.startPos=a.getPosition();this.allTime=0;this.speedX=(this.desPos.x-this.startPos.x)/this._duration;this.speedY=(this.desPos.y-this.startPos.y)/this._duration},step:function(a){var b=this.target.getPosition(),b=qc.p(b.x+this.speedX*a,b.y+this.speedY*a);this.allTime+=a;this.allTime>
this._duration&&(b=this.desPos,this._isDone=!0);this.target.setPosition(b)},isDone:function(){return this._isDone}});qc.MoveTo.create=function(a,b){return new qc.MoveTo(a,b)};qc.MoveBy=qc.MoveTo.extend({_movePos:null,ctor:function(a,b){this._super(a,b);this._movePos=b},startWithTarget:function(a){var b=a.getPosition();this.desPos=qc.p(b.x+this._movePos.x,b.y+this._movePos.y);this._super(a)}});qc.MoveBy.create=function(a,b){return new qc.MoveBy(a,b)};qc.RepeatForever=qc.Action.extend({selfAction:null,_isDone:!1,_loops:null,_count:0,_duration:0,ctor:function(a,b){this._super();this.selfAction=a;this._loops=b},startWithTarget:function(a){this._super(a);this.selfAction.startWithTarget(a);this._count=0;this._isDone=!1},step:function(a){this.selfAction.step(a);this.selfAction.isDone()&&(this._count++,this._loops&&this._count>=this._loops?this._isDone=!0:this.selfAction.startWithTarget(this.target))},isDone:function(){return this._isDone}});
qc.RepeatForever.create=function(a,b){return new qc.RepeatForever(a,b)};qc.RotateTo=qc.Action.extend({desRotate:null,startRotate:null,allTime:0,speed:0,_isDone:!1,ctor:function(a,b){this._super();this._duration=a;this.desRotate=b},startWithTarget:function(a){this._super(a);this._isDone=!1;this.startRotate=a.getRotation();this.allTime=0;this.speed=(this.desRotate-this.startRotate)/this._duration},step:function(a){var b=this.target.getRotation()+this.speed*a;this.allTime+=a;this.allTime>this._duration&&(b=this.desRotate,this._isDone=!0);this.target.setRotation(b)},isDone:function(){return this._isDone}});
qc.RotateTo.create=function(a,b){return new qc.RotateTo(a,b)};qc.Sequence=qc.Action.extend({_actions:null,hasStartAction2:!1,_isDone:!1,ctor:function(a){this._super();this._actions=[];var b=a instanceof Array?a:arguments,c=b.length-1;if(0<=c){for(var d=b[0],e=1;e<c;e++)b[e]&&(d=qc.Sequence._actionOneTwo(d,b[e]));this.initWithTwoActions(d,b[c])}},initWithTwoActions:function(a,b){this.initWithDuration(a._duration+b._duration);this._actions[0]=a;this._actions[1]=b;return!0},initWithDuration:function(a){this._duration=a},startWithTarget:function(a){this._super(a);
this._actions[0].startWithTarget(a);this.hasStartAction2=this._isDone=!1},step:function(a){var b=this._actions[0];if(this.hasStartAction2){var c=this._actions[1];c.step(a);c.isDone()&&(this._isDone=!0)}else b.step(a),b.isDone()&&(c=this._actions[1],this.hasStartAction2||(c.startWithTarget(this.target),b.stop(),this.hasStartAction2=!0))},isDone:function(){return this._isDone}});qc.Sequence._actionOneTwo=function(a,b){var c=new qc.Sequence;c.initWithTwoActions(a,b);return c};qc.Sequence.create=function(a){return new qc.Sequence(a)};