var res={bg:"res/images/background.png",fishes:"res/images/fishes.png",fishplist:"res/plists/fishes.plist"},start_resources=[res.bg,res.fishes,res.fishplist],g_resources=[];var WinSprite=qc.Sprite.extend({openFrame:null,closeFrame:null,mySprite:null,isOpenFlag:null,init:function(a){this.isOpenFlag=a;this.initSprite(a)},initSprite:function(a){var b=qc.SpriteFrameCache._getInstance();b.addSpriteFrames(res.fishplist,res.fishes);this.openFrame=b.getSpriteFrame("window-open.png");this.closeFrame=b.getSpriteFrame("window-close.png");this.mySprite=0==a?qc.Sprite.create(this.openFrame):qc.Sprite.create(this.closeFrame);this.addChild(this.mySprite)},reflectFlag:function(){this.isOpenFlag=
!this.isOpenFlag;0==this.isOpenFlag?this.mySprite.setSpriteFrame(this.openFrame):this.mySprite.setSpriteFrame(this.closeFrame)},isOpen:function(){return 0==this.isOpenFlag}});WinSprite.create=function(a){var b=new WinSprite;b.init(a);return b};var PanLayer=qc.Layer.extend({bgSprite:null,frameCache:null,panWidth:0,panHeight:0,_beginX:0,_beginY:0,_winWidth:0,_winHeight:0,winSpriteMap:{},panArray:null,init:function(){this.initPanArray();this.initFrameCache();this.initBg();this.initWindow()},initFrameCache:function(){var a=qc.SpriteFrameCache._getInstance();a.addSpriteFrames(res.fishplist,res.fishes);this.frameCache=a},initBg:function(){var a=this.frameCache.getSpriteFrame("window-border.png");this.bgSprite=qc.Sprite.create(a);a=this.bgSprite.getTextureRect();
this.panWidth=a.width;this.panHeight=a.height;this.addChild(this.bgSprite)},initWindow:function(){this.initWindowBegin();for(var a=0;3>a;a++)for(var b=0;3>b;b++){var c=WinSprite.create(this._findPanValue(a,b));this.addChild(c);this.winSpriteMap[a+","+b]=c;c.setPosition(this._giveMePositionByXY(a,b))}},initWindowBegin:function(){var a=this.panWidth/3,b=this.panHeight/3,c=this.panHeight/2-b/2;this._beginX=-this.panWidth/2+a/2;this._beginY=c;this._winWidth=a;this._winHeight=b},findWinSprite:function(a,
b){return this.winSpriteMap[a+","+b]},_findPanValue:function(a,b){return this.panArray[a+3*b]},_giveMePositionByXY:function(a,b){return qc.p(this._beginX+a*this._winWidth,this._beginY-b*this._winHeight)},checkPan:function(a){var b=this.getPosition(),c=this.getScale(),b=qc.p((a.x-b.x)/c,(a.y-b.y)/c);a=parseInt((b.x-(this._beginX-this._winWidth/2))/this._winWidth);b=parseInt((this._beginY+this._winHeight/2-b.y)/this._winHeight);return 2<a||2<b||0>a||0>b?null:qc.p(a,b)},clickIndexP:function(a){a=this._findAllSideIndex(a);
for(var b=a[0],c=0;b;b=a[++c])(b=this.findWinSprite(b.x,b.y))&&b.reflectFlag()},_findAllSideIndex:function(a){var b=[];b.push(qc.p(a.x-1,a.y));b.push(qc.p(a.x,a.y-1));b.push(qc.p(a.x+1,a.y));b.push(qc.p(a.x,a.y+1));b.push(a);return b},initPanArray:function(){this.panArray=[0,0,0,0,0,0,0,0,0];for(var a=0;5>a;a++){var b=Math.floor(3*Math.random()),c=Math.floor(3*Math.random());this._relectPanValue(b,c)}console.log(this.panArray)},_relectPanValue:function(a,b){"undefined"!=typeof this._findPanValue(a,
b)&&(this.panArray[a+3*b]=!this.panArray[a+3*b])}});PanLayer.create=function(){var a=new PanLayer;a.init();return a};var LoaderScene=qc.Scene.extend({_interval:null,_length:0,_count:0,_label:null,_className:"LoaderScene",init:function(){return!0},_initStage:function(a,b){var c=this._texture2d=new qc.Texture2D;c.initWithElement(a);c.handleLoadedTexture();c=this._logo=qc.Sprite.create(c);c.setScale(qc.contentScaleFactor());c.x=b.x;c.y=b.y;this._bgLayer.addChild(c,10)},onEnter:function(){qc.Node.prototype.onEnter.call(this);this._startLoading()},onExit:function(){qc.Node.prototype.onExit.call(this)},initWithResources:function(a,
b){"string"==typeof a&&(a=[a]);this.resources=a||[];this.cb=b},_startLoading:function(){var a=this,b=a.resources;a._length=b.length;a._count=0;qc.loader.load(b,function(b,h){a._count=h},function(){a.cb&&a.cb()})},_updatePercent:function(){var a=this._count/this._length*100|0,a=Math.min(a,100);qc.log(a)}});LoaderScene.preload=function(a,b){this.loaderScene||(this.loaderScene=new LoaderScene,this.loaderScene.init());this.loaderScene.initWithResources(a,b);qc.director.runScene(this.loaderScene);return this.loaderScene};var GameLayer=qc.Layer.extend({bgSprit:null,panLayer:null,winSize:null,hasWin:!1,clickNum:0,init:function(){this.winSize=qc.director.getWinSize();this.initBg();this.initPan();this.initListener()},initBg:function(){var a=this.winSize;this.bgSprit=qc.Sprite.create(res.bg);this.addChild(this.bgSprit);this.bgSprit.setPosition(qc.p(a.width/2,a.height/2));this.bgSprit.setScale(0.5)},initPan:function(){var a=this.winSize,b=PanLayer.create();this.addChild(b);b.setPosition(qc.p(a.width/2,a.height/2));b.setScale(0.5);
this.panLayer=b},checkGame:function(){for(var a=this.panLayer,b=!0,c=0;3>c;c++)for(var h=0;3>h;h++)if(!a.findWinSprite(c,h).isOpen()){b=!1;break}if(b){var l=this;setTimeout(function(){alert("\u4f60\u8d62\u4e86\uff01\u4f60\u70b9\u51fb\u4e86"+l.clickNum+"\u4e0b")});this.hasWin=!0}},initListener:function(){qc.EventManager.addListener({event:qc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this)},
this)},onTouchBegan:function(a,b){if(!this.hasWin){var c=a.getLocation(),h=this.panLayer,c=h.checkPan(c);null!=c&&(this.clickNum++,h.clickIndexP(c));this.checkGame()}},onTouchMoved:function(a,b){},onTouchEnded:function(a,b){}}),GameScene=qc.Scene.extend({onEnter:function(){this._super();var a=new GameLayer;a.init();this.addChild(a)}});var AI=AI||{};
AI.resolve=function(a){function b(a,b){if("number"==typeof b)return b^a;for(var c=b.length,d=0;d<c;d++)b[d]^=a[d]}var c=[[1,1,0,1,0,0,0,0,0],[1,1,1,0,1,0,0,0,0],[0,1,1,0,0,1,0,0,0],[1,0,0,1,1,0,1,0,0],[0,1,0,1,1,1,0,1,0],[0,0,1,0,1,1,0,0,1],[0,0,0,1,0,0,1,1,0],[0,0,0,0,1,0,1,1,1],[0,0,0,0,0,1,0,1,1]];(function(a,c){for(var k=a.length,d=0;d<k;d++){for(var e=d+1;e<k;e++){var f=a[d],g=a[e];1==g[d]&&(1==f[d]?(b(f,g),f=c[d],g=c[e],c[e]=b(f,g)):(f=a[d],a[d]=a[e],a[e]=f,f=c[d],c[d]=c[e],c[e]=f))}if(1!=a[d][d])throw"\u65e0\u89e3\uff01\uff01";
for(e=0;e<d;e++)f=a[d],g=a[e],1==g[d]&&(b(f,g),f=c[d],g=c[e],c[e]=b(f,g))}})(c,a);console.log(c);console.log(a)};qc.game.onStart=function(){LoaderScene.preload(start_resources,function(){var a=new GameScene;qc.director.runScene(a)})};qc.game.run();