var res={smallPeople1:"res/images/404.png",smallPeople2:"res/images/405.png",smallPeople3:"res/images/406.png",smallPeople4:"res/images/407.png",smallPeople5:"res/images/408.png",smallPeople6:"res/images/409.png",smallPeople7:"res/images/410.png",smallPeople8:"res/images/411.png",smallPeople9:"res/images/412.png",smallPeople10:"res/images/413.png",smallPeople11:"res/images/414.png",smallPeople12:"res/images/415.png",smallPeople13:"res/images/416.png",smallPeople14:"res/images/417.png",smallPeople15:"res/images/418.png",
smallPeople16:"res/images/419.png",smallPeople17:"res/images/420.png",smallPeople18:"res/images/421.png",smallPeople19:"res/images/422.png",smallPeople20:"res/images/423.png",smallPeople21:"res/images/424.png",smallPeople22:"res/images/425.png",smallPeople23:"res/images/426.png",smallPeople24:"res/images/427.png",smallPeople25:"res/images/428.png",smallPeople26:"res/images/429.png",smallPeople27:"res/images/430.png",smallPeople28:"res/images/431.png",smallPeople29:"res/images/432.png",smallPeople30:"res/images/433.png",
smallPeople31:"res/images/434.png",background:"res/images/background.png"},start_resources=[res.smallPeople1,res.smallPeople2,res.smallPeople3,res.smallPeople4,res.smallPeople5,res.smallPeople6,res.smallPeople7,res.smallPeople8,res.smallPeople9,res.smallPeople10,res.smallPeople11,res.smallPeople12,res.smallPeople13,res.smallPeople14,res.smallPeople15,res.smallPeople16,res.smallPeople17,res.smallPeople18,res.smallPeople19,res.smallPeople20,res.smallPeople22,res.smallPeople23,res.smallPeople24,res.smallPeople25,
res.smallPeople26,res.smallPeople27,res.smallPeople28,res.smallPeople29,res.smallPeople30,res.smallPeople31,res.background],peopleRes=[res.smallPeople1,res.smallPeople2,res.smallPeople3,res.smallPeople4,res.smallPeople5,res.smallPeople6,res.smallPeople7,res.smallPeople8,res.smallPeople9,res.smallPeople10,res.smallPeople11,res.smallPeople12,res.smallPeople13,res.smallPeople14,res.smallPeople15,res.smallPeople16,res.smallPeople17,res.smallPeople18,res.smallPeople19,res.smallPeople20,res.smallPeople22,
res.smallPeople23,res.smallPeople24,res.smallPeople25,res.smallPeople26,res.smallPeople27,res.smallPeople28,res.smallPeople29,res.smallPeople30,res.smallPeople31];var LoaderScene=qc.Scene.extend({_interval:null,_length:0,_count:0,_label:null,_className:"LoaderScene",winSize:null,init:function(){this.winSize=qc.director.getWinSize();var a=this._bgLayer=qc.Layer.create();a.setPosition(qc.p(this.winSize.width/2,this.winSize.height/2));this.addChild(a);var b=this._label=qc.Label.create("Loading... 0%","Arial",24);b.setColor(qc.color(180,180,180));b.setPosition(qc.p(-60,0));a.addChild(this._label);return!0},_initStage:function(a,b){var c=this._texture2d=new qc.Texture2D;
c.initWithElement(a);c.handleLoadedTexture();c=this._logo=qc.Sprite.create(c);c.setScale(qc.contentScaleFactor());c.x=b.x;c.y=b.y;this._bgLayer.addChild(c,10)},onEnter:function(){qc.Node.prototype.onEnter.call(this);this._startLoading()},onExit:function(){qc.Node.prototype.onExit.call(this);this._label.setString("Loading... 0%")},initWithResources:function(a,b){"string"==typeof a&&(a=[a]);this.resources=a||[];this.cb=b},_startLoading:function(){var a=this,b=a.resources;a._length=b.length;a._count=
0;qc.loader.load(b,function(b,f){a._count=f},function(){a.cb&&a.cb()});this._interval=setInterval(function(){a._updatePercent()},100)},_updatePercent:function(){var a=this._count,b=this._length,c;c=Math.min(a/b*100|0,100);qc.log(c);this._label.setString("Loading... "+c+"%");a>=b&&null!=this._interval&&clearInterval(this._interval)}});
LoaderScene.preload=function(a,b){this.loaderScene||(this.loaderScene=new LoaderScene,this.loaderScene.init());this.loaderScene.initWithResources(a,b);qc.director.runScene(this.loaderScene);return this.loaderScene};var ShowLayer=qc.Layer.extend({beginPos:null,arrowX:null,arrowY:null,winSize:null,lineHeads:null,nowStr:"",fontSprites:null,init:function(){this.initData();var a=UpPeople.createWithFont("\n");this.addChild(a);a.setPosition(this.beginPos);this.fontSprites.push(a)},initData:function(){this.winSize=qc.director.getWinSize();this.beginPos=qc.p(-110,this.winSize.width/2-30);this.arrowX=qc.p(60,30);this.arrowY=qc.p(-75,60);this.lineHeads=[];this.lineHeads.push(this.beginPos);this.fontSprites=[]},_nextPos:function(a){var b=
this.arrowX;return qc.p(a.x+b.x,a.y-b.y)},_nextLine:function(){var a=this.lineHeads[this.lineHeads.length-1],b=this.arrowY;return qc.p(a.x+b.x,a.y-b.y)},add:function(a){this.diff(a)},diff:function(a){for(var b=this.nowStr,c=b.length,f=a.length,d=0;d<c&&d<f;d++){var g=b.charAt(d),e=a.charAt(d);if(e!=g)break}for(c-=1;c>=d;c--)e=b.charAt(c),this._reduce(e);this.nowStr=b.substr(0,d);for(c=d;c<f;c++)e=a.charAt(c),this._add(e);this.nowStr+=a.substring(d)},_reduce:function(a){"\n"==a&&this.lineHeads.pop();
this.fontSprites.pop().removeFromParent()},_getLastPos:function(){var a=this.fontSprites.length;return 0<a?this.fontSprites[a-1].getPosition():this.beginPos},_add:function(a){if("\n"==a){var b=this._nextLine();this.lineHeads.push(b)}else b=this._getLastPos(),b=this._nextPos(b);a=UpPeople.createWithFont(a);this.addChild(a);a.setPosition(b);this.fontSprites.push(a)}});ShowLayer.create=function(){var a=new ShowLayer;a.init();return a};var UpPeople=qc.Sprite.extend({pSprite:null,font:"",init:function(a){this._super();this.font=a;this.initPeople()},initPeople:function(){if("\n"!=this.font&&" "!=this.font){var a=this._randomNum(peopleRes.length),a=this.pSprite=qc.Sprite.create(peopleRes[a]);this.addChild(a);a=qc.Label.create(this.font,"\u5fae\u8f6f\u96c5\u9ed1","bold 30");this.addChild(a);a.setColor(qc.color(255,0,153));a.setPosition(qc.p(-20,70));a.setRotation(38)}},_randomNum:function(a){return parseInt(Math.random()*a)}});
UpPeople.createWithFont=function(a){var b=new UpPeople;b.init(a);return b};var UpLayer=qc.Layer.extend({bgSprite:null,bgLayer:null,peopleLayer:null,winSize:null,midpos:null,init:function(){this.initData();this.initBg();this.initPeople();this.initListener()},initData:function(){this.winSize=qc.director.getWinSize();this.midpos=qc.p(this.winSize.width/2,this.winSize.height/2)},initBg:function(){this.bgSprite=qc.Sprite.create(res.background);this.bgLayer=qc.Layer.create();this.addChild(this.bgLayer);this.bgLayer.addChild(this.bgSprite);this.bgLayer.setPosition(this.midpos);
var a=qc.Label.create("\u4e3e\u724c\u5c0f\u4eba","\u5fae\u8f6f\u96c5\u9ed1","bold 40");a.setColor(qc.color(255,51,204));a.setPosition(qc.p(-80,300));this.bgLayer.addChild(a)},initPeople:function(){this.peopleLayer=ShowLayer.create();this.addChild(this.peopleLayer);this.peopleLayer.setScale(0.75);this.peopleLayer.setPosition(this.midpos)},initListener:function(){var a=this,b=$("#gameCanvas").width(),c=$("#gameCanvas").height();$(".in").height(0.2*c);$("#inText").width(0.8*b).show();$("#inText").on("input",
function(){var b=$(this).val();a.peopleLayer.add(b)})}}),UpScene=qc.Scene.extend({onEnter:function(){this._super();var a=new UpLayer;a.init();this.addChild(a)}});qc.game.onStart=function(){LoaderScene.preload(start_resources,function(){var a=new UpScene;qc.director.runScene(a)})};qc.game.run();